server {
    listen 80;
    server_name reversus.online;

    root /usr/share/nginx/html;
    index index.html;

    # ✅ BLOQUEAR CAMINHOS COMUNS DE INVASÃO (WordPress, etc.)
    location ~* /(wp-admin|wp-login\.php|xmlrpc\.php|wp-content|wp-includes|wordpress|setup-config\.php) {
        return 403;
    }

    # ✅ BLOQUEAR ACESSO A ARQUIVOS SENSÍVEIS
    location ~* (\.env|config\.php|\.git|\.htaccess|\.bak|\.zip|\.tar) {
        return 403;
    }

    # ✅ RATE LIMITING (mais agressivo)
    limit_req_zone $binary_remote_addr zone=req_limit_per_ip:10m rate=5r/m;

    location / {
        limit_req zone=req_limit_per_ip burst=5 nodelay;
    }

    # ✅ BAN TEMPORÁRIO PARA TENTATIVAS SUSPEITAS
    # Adiciona header para fail2ban detectar e banir
    location ~* /(wp-admin|wp-login\.php|setup-config\.php|xmlrpc\.php) {
        add_header X-Attack-Detected "true";
        return 403;
    }

    # ✅ RESPOSTA PARA /robots.txt (SEO-friendly)
    location = /robots.txt {
        default_type text/plain;
        return 200 "User-agent: *\nAllow: /\n";
    }

    # ✅ ERROS PADRÃO
    error_page 403 404 500 502 503 504 /custom_40x.html;

    location = /custom_40x.html {
        internal;
    }
}
